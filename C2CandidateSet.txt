import java.io.File;
import java.io.FileNotFoundException;
import java.util.ArrayList;
import java.util.List;
import java.util.Scanner;
import java.util.StringTokenizer;

import scala.Array;


public class C2CandidateSet {
	
	public static void main(String args[]) throws FileNotFoundException{
	
	
		File file = new File("C:/Users/KRITHIVASAN CHANDRAN/Desktop/proj_1/CandidateItemSets2.txt");
		File transactionFile = new File("C:/Users/KRITHIVASAN CHANDRAN/Desktop/proj_1/binaryTransactionDB.txt");
		
		Scanner candidateScan = new Scanner(file);
		Scanner transactionScan = new Scanner(transactionFile);
		StringBuffer buffer = new StringBuffer();
		StringBuffer finalItemSet = new StringBuffer();
		int i = 0;
		int validator = 2;
		transactionScan.useDelimiter(System.getProperty("line.separator")); 
		int frequencycounter = 0;

		// Reading the value from Candidate Scan 2
		
		while(candidateScan.hasNext()){
			
			String str = candidateScan.nextLine();
			buffer.append(str);
			// line separator
			buffer.append("||");
		}
		candidateScan.close();
		
		//Compares the UniqueItemSet for k=2 with TransactionDB.
		
		while(transactionScan.hasNext()){
					
			String papaya = transactionScan.nextLine().trim();

					String s = buffer.toString();
					List<String> itemSet = new ArrayList<>();
					
					for(;s.indexOf("||") != -1;){
						int delimeterindex = s.indexOf("||");
						String split = s.substring(0, delimeterindex);
						StringTokenizer tokenizer = new StringTokenizer(split,",");
						while(tokenizer.hasMoreTokens()){
							String elements = tokenizer.nextToken();
							itemSet.add(elements);
						}
						
						if(papaya.contains(" ")){
							papaya = papaya.replaceAll("\\s+",",");
							StringTokenizer tokenizers = new StringTokenizer(papaya,",");
							List<String> tempList = new ArrayList<>();
							while(tokenizers.hasMoreTokens()){
								String elements = tokenizers.nextToken();
								tempList.add(elements);
							}
							List<String> dummyitemSet = itemSet;
							
							if(tempList.size() >= dummyitemSet.size()){
								int dummyitemSize = dummyitemSet.size();
								if(dummyitemSet.retainAll(tempList)){
									if(dummyitemSize == dummyitemSet.size()){
										frequencycounter =+ 1;
										for(String finalItems : tempList){
											System.out.println(" appending values " + finalItems );
											finalItemSet.append(tempList);
											finalItemSet.append(",");
										}
										finalItemSet.append("|||");
										finalItemSet.append("\n");
										tempList.clear();
									}
								}
							}else{
								tempList.clear();
							}
						}
					 s = s.substring(delimeterindex+2, s.length());
					 if(s.indexOf("||") != -1){
						 continue;
					 }
					}
					}
		transactionScan.close();
		System.out.println(finalItemSet.toString());
	}
}
